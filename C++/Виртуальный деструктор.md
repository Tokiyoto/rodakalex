Виртуальный деструктор — это концепция из [[C++/ООП|Объектно-ориентированного программирования]], особенно актуальная в языке C++. Он необходим для правильного управления ресурсами в иерархии наследования.

Когда вы используете наследование в C++, часто создается базовый класс и несколько производных классов. Если объект производного класса создается через указатель на базовый класс, то при удалении этого объекта через указатель на базовый класс без виртуального деструктора может возникнуть проблема утечки ресурсов или неправильного освобождения памяти.

Вот почему виртуальный деструктор важен:

1. **Правильное освобождение ресурсов**: Когда базовый класс имеет виртуальный деструктор, при удалении объекта производного класса через указатель на базовый класс, сначала вызывается деструктор производного класса, а затем деструктор базового класса. Это обеспечивает корректное освобождение ресурсов, выделенных в производном классе.

2. **Безопасность и предотвращение утечек**: Без виртуального деструктора при удалении объекта через указатель на базовый класс может произойти только вызов деструктора базового класса, что может привести к утечке памяти или неправильному освобождению ресурсов, если производный класс выделяет какие-то ресурсы.

Пример:

```cpp
#include <iostream>

class Base {
public:
    Base() { std::cout << "Base Constructor" << std::endl; }
    virtual ~Base() { std::cout << "Base Destructor" << std::endl; } // Виртуальный деструктор
};

class Derived : public Base {
public:
    Derived() { std::cout << "Derived Constructor" << std::endl; }
    ~Derived() { std::cout << "Derived Destructor" << std::endl; }
};

int main() {
    Base* obj = new Derived();
    delete obj;  // Корректное освобождение ресурсов
    return 0;
}
```

В этом примере, когда `delete obj` вызывается, сначала вызывается деструктор `Derived`, а затем деструктор `Base`. Это гарантирует правильное освобождение ресурсов.

Если деструктор базового класса не будет виртуальным, при вызове `delete obj` будет вызван только деструктор базового класса, что может привести к утечке ресурсов и неопределенному поведению.

[[C++]]